---
published: false
---

From the file `AmStatusInstall.mof` in the folder `C:\Program Files\Windows Defender`:

    [
        Description("Overall product status (MPSTATUS_FLAG enumeration bitmask)"): ToInstance ToSubClass,
        read: ToInstance ToSubClass,
        ValueMap {"0x000000", "0x000001", "0x000002", "0x000004", "0x000008", "0x000010", "0x000020", "0x000040", "0x000080", "0x000100", "0x000200", "0x000400", "0x000800", "0x001000", "0x002000", "0x004000", "0x008000", "0x010000", "0x020000", "0x040000", "0x080000", "0x100000", "0x200000"},
        Values {"NONE", "SERVICE_UNAVAILABLE", "MPENGINE_UNAVAILABLE", "THREAT_FULLSCAN_REQUIRED", "THREAT_REBOOT_REQUIRED", "THREAT_MANUAL_STEPS_REQUIRED", "DUE_AV_SIGNATURE", "DUE_AS_SIGNATURE", "DUE_QUICK_SCAN", "DUE_FULL_SCAN", "INPROGRESS_SYSTEM_SCAN", "INPROGRESS_ROUTINE_CLEANING", "DUE_SAMPLES", "EVALUATION_MODE", "NONGENUINE", "PRODUCT_EXPIRED", "THREAT_CALLISTO_REQUIRED", "SERVICE_ON_SYSTEM_SHUTDOWN", "SERVICE_CRITICAL_FAILURE", "SERVICE_NON_CRITICAL_FAILURE", "HEALTH_INITIALIZED", "DUE_PLATFORM_UPDATE", "INPROGRESS_PLATFORM_UPDATE"}
    ] 
    uint32 ProductStatus = 0;

This relevance appears to decipher the ProdcutState value:

    tuple string items ( (it as integer + 1) of ends of substrings "1" of (concatenations of characters ( lengths of following texts of positions of it ) of it) of (it as bit set as string) of integer values of selects "productState FROM AntiVirusProduct" of wmis "ROOT\SecurityCenter2" ) of "NONE, SERVICE_UNAVAILABLE, MPENGINE_UNAVAILABLE, THREAT_FULLSCAN_REQUIRED, THREAT_REBOOT_REQUIRED, THREAT_MANUAL_STEPS_REQUIRED, DUE_AV_SIGNATURE, DUE_AS_SIGNATURE, DUE_QUICK_SCAN, DUE_FULL_SCAN, INPROGRESS_SYSTEM_SCAN, INPROGRESS_ROUTINE_CLEANING, DUE_SAMPLES, EVALUATION_MODE, NONGENUINE, PRODUCT_EXPIRED, THREAT_CALLISTO_REQUIRED, SERVICE_ON_SYSTEM_SHUTDOWN, SERVICE_CRITICAL_FAILURE, SERVICE_NON_CRITICAL_FAILURE, HEALTH_INITIALIZED, DUE_PLATFORM_UPDATE, INPROGRESS_PLATFORM_UPDATE"

- WD - MSE - SCEP - Microsoft Antimalware Audit - Windows https://bigfix.me/analysis/details/2994634
- Status of Windows Defender - Windows WMI https://bigfix.me/relevance/details/3017890
- Windows Defender Settings - Windows WMI https://bigfix.me/relevance/details/3017891

### References:
- https://developer.bigfix.com/relevance/reference/substring.html#end-of-substring-string-position
- https://developer.bigfix.com/relevance/reference/substring.html#substring-string-of-string-substring
- https://developer.bigfix.com/relevance/reference/bit-set.html#integer-as-bit-set-bit-set
- https://bigfix.me/relevance/details/3007515
- Applications - Antivirus - Windows https://bigfix.me/analysis/details/2998358

### Related:
- https://social.technet.microsoft.com/Forums/scriptcenter/en-US/aadc35ea-066f-4923-8aa8-a3252ceb7c5f/using-powershell-to-monitor-microsoft-security-essentials?forum=ITCG
- https://blogs.msdn.microsoft.com/alejacma/2008/05/12/how-to-get-antivirus-information-with-wmi-vbscript/

